generator client {
  provider = "prisma-client"
  output   = "./generated"
}

datasource db {
  provider = "postgresql"
}

// ✅ Переписанные enum-ы
enum ItemSize {
  XS
  S
  M
  L
  XL
  XXL
  XXXL
}

enum ItemGender {
  male
  female
  child
  unisex
}

enum UserRole {
  ADMIN
  MEMBER
}

// ✅ Новые модели
model Group {
  id    String @id @default(uuid())
  title String @unique
  items Item[]

  @@map("groups") // Таблица будет называться groups
}

model Item {
  id             String     @id @default(uuid())
  name           String
  description    String
  stock          Int
  price          Float      @default(0)
  availableSizes ItemSize[] @default([])
  slug           String     @unique
  tags           String[]   @default([])
  gender         ItemGender

  // Связь с группой
  groupId String
  group   Group  @relation(fields: [groupId], references: [id])

  images ItemImage[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([gender])
}

model ItemImage {
  id     Int    @id @default(autoincrement())
  url    String
  itemId String
  item   Item   @relation(fields: [itemId], references: [id])

  @@map("item_images")
}

model Account {
  id            String    @id @default(uuid())
  username      String
  email         String    @unique
  emailVerified DateTime?
  passwordHash  String
  role          UserRole  @default(MEMBER)
  avatar        String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("accounts")
}
